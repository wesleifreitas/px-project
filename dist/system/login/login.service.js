define(["../services/module"],function(e){"use strict";function r(e,r,t,n,a,i){function s(o,t,n){var a={username:o,password:t,dsn:e.PROJECT_DSN};r({method:"POST",url:h+"system/login/login.cfc?method=login",params:a}).success(function(e){n(e)}).error(function(e,r,o,t){alert("Ops! Ocorreu um erro inesperado.\nPor favor contate o administrador do sistema!")})}function c(e){r({method:"POST",url:h+"system/login/login.cfc?method=loggedIn"}).success(function(r){e(r)}).error(function(e,r,o,t){alert("Ops! Ocorreu um erro inesperado.\nPor favor contate o administrador do sistema!")})}function d(e){r({method:"POST",url:h+"system/login/login.cfc?method=logout"}).success(function(r){e(r)}).error(function(e,r,o,t){alert("Ops! Ocorreu um erro inesperado.\nPor favor contate o administrador do sistema!")})}function u(e,a,i){var s=o.encode(e+":"+a);n.globals={currentUser:{username:e,authdata:s}},angular.forEach(i.qQuery[0],function(e,r){n.globals.currentUser[r.toLowerCase()]=e}),r.defaults.headers.common.Authorization="Basic "+s,t.put("globals",n.globals)}function l(){n.globals={},t.remove("globals"),r.defaults.headers.common.Authorization="Basic "}function m(o,t,n,a){var i={id:o,username:t,password:n,dsn:e.PROJECT_DSN};r({method:"POST",url:"custom/login/login.cfc?method=redefine",params:i}).success(function(e){a(e)}).error(function(e,r,o,t){alert("Ops! Ocorreu um erro inesperado.\nPor favor contate o administrador do sistema!")})}function f(o,t,n){var a={username:o,email:t,dsn:e.PROJECT_DSN};r({method:"POST",url:"custom/login/login.cfc?method=recover",params:a}).success(function(e){n(e)}).error(function(e,r,o,t){alert("Ops! Ocorreu um erro inesperado.\nPor favor contate o administrador do sistema!")})}var h=angular.copy(e.PX_PACKAGE);""!==h&&(h+="/");var g={};return g.Login=s,g.LoggedIn=c,g.Logout=d,g.SetCredentials=u,g.ClearCredentials=l,g.Redefine=m,g.Recover=f,g}e.factory("loginService",r),r.$inject=["pxConfig","$http","$cookieStore","$rootScope","$timeout","UserService"];var o={keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var r,o,t,n,a,i="",s="",c="",d=0;do r=e.charCodeAt(d++),o=e.charCodeAt(d++),s=e.charCodeAt(d++),t=r>>2,n=(3&r)<<4|o>>4,a=(15&o)<<2|s>>6,c=63&s,isNaN(o)?a=c=64:isNaN(s)&&(c=64),i=i+this.keyStr.charAt(t)+this.keyStr.charAt(n)+this.keyStr.charAt(a)+this.keyStr.charAt(c),r=o=s="",t=n=a=c="";while(d<e.length);return i},decode:function(e){var r,o,t,n,a,i="",s="",c="",d=0,u=/[^A-Za-z0-9\+\/\=]/g;u.exec(e)&&window.alert("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\nExpect errors in decoding."),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");do t=this.keyStr.indexOf(e.charAt(d++)),n=this.keyStr.indexOf(e.charAt(d++)),a=this.keyStr.indexOf(e.charAt(d++)),c=this.keyStr.indexOf(e.charAt(d++)),r=t<<2|n>>4,o=(15&n)<<4|a>>2,s=(3&a)<<6|c,i+=String.fromCharCode(r),64!==a&&(i+=String.fromCharCode(o)),64!==c&&(i+=String.fromCharCode(s)),r=o=s="",t=n=a=c="";while(d<e.length);return i}}});