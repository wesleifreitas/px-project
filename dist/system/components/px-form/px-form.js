define(["../../directives/module"],function(e){"use strict";function n(e,n,t){n.insert=function(){var t=JSON.parse(n.config),i=t.table,l=t.pk,r=t.fields;angular.isDefined(i)||(i=n.table),angular.isDefined(l)||(l=JSON.parse(n.pk)),angular.isDefined(r)||(r=JSON.parse(n.fields)),angular.forEach(r,function(e){if(e.valueObject={},angular.isDefined(e.element)){var n="#"+e.element,t=e.element;if(angular.isDefined(angular.element($(n+"_pxComplete").get(0)).scope())&&(n+="_pxComplete",t="selectedItem"),angular.element($(n).get(0)).scope().hasOwnProperty(t)){var i=angular.element($(n).get(0)).scope()[t];if(!angular.isDefined(i))return;var l=e.field,r=i;angular.isDefined(e.fieldValueOptions)&&(l=e.fieldValueOptions.field,i?(r=i[e.fieldValueOptions.selectedItem],angular.isDefined(r)||(r=i[e.fieldValueOptions.selectedItem.toUpperCase()]),"%"===r&&(r=null)):r=null),null!==r&&""!==r?e.valueObject={field:l,value:r}:e.valueObject={}}else e.valueObject={}}}),e.insert(i,angular.toJson(l),angular.toJson(r),function(e){n.debug&&console.info("pxFormService.insert response: ",e),e.success?alert(":)"):alert("Ops! Ocorreu um erro inesperado.\nPor favor contate o administrador do sistema!")})}}e.directive("pxForm",["$timeout",function(e){return{restrict:"E",replace:!1,transclude:!1,template:"<div></div>",scope:{debug:"=pxDebug",config:"@pxConfig",table:"@pxTable",pk:"@pk",fields:"@pxFields",init:"&pxInit",control:"=pxControl"},link:function(n,t,i){n.internalControl=n.control||{},n.internalControl.insert=function(){n.insert()},e(n.init,0)},controller:n}}]),n.$inject=["pxFormService","$scope","$http"]});