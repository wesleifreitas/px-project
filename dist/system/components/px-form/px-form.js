define(["../../directives/module"],function(e){"use strict";function n(e,n,t){n.insert=function(){var t=JSON.parse(n.config),l=t.table,i=t.pk,a=t.fields;angular.isDefined(l)||(l=n.table),angular.isDefined(i)||(i=JSON.parse(n.pk)),angular.isDefined(a)||(a=JSON.parse(n.fields)),angular.forEach(a,function(e){if(e.valueObject={},angular.isDefined(e.element)){var n="#"+e.element,t=e.element;if(angular.isDefined(angular.element($(n+"_pxComplete").get(0)).scope())&&(n+="_pxComplete",t="selectedItem"),angular.element($(n).get(0)).scope().hasOwnProperty(t)){var l=angular.element($(n).get(0)).scope()[t];if(!angular.isDefined(l))return;var i=e.field,a=l;angular.isDefined(e.fieldValueOptions)&&(i=e.fieldValueOptions.field,l?(a=l[e.fieldValueOptions.selectedItem],angular.isDefined(a)||(a=l[e.fieldValueOptions.selectedItem.toUpperCase()]),"%"===a&&(a=null)):a=null),null!==a&&""!==a?e.valueObject={field:i,value:a}:e.valueObject={}}else e.valueObject={}}}),e.insert(l,angular.toJson(i),angular.toJson(a),function(e){n.debug&&console.info("pxFormService.insert response: ",e),e.success?n.callback&&n.callback({event:e}):alert("Ops! Ocorreu um erro inesperado.\nPor favor contate o administrador do sistema!")})}}e.directive("pxForm",["$timeout",function(e){return{restrict:"E",replace:!1,transclude:!1,template:"<div></div>",scope:{debug:"=pxDebug",config:"@pxConfig",table:"@pxTable",pk:"@pk",fields:"@pxFields",init:"&pxInit",callback:"&pxCallback",control:"=pxControl"},link:function(n,t,l){n.internalControl=n.control||{},n.internalControl.insert=function(){n.insert()},n.internalControl.update=function(){n.update()},e(n.init,0)},controller:n}}]),n.$inject=["pxFormService","$scope","$http"]});